{
  "version": "2.0",
  "last_updated": "2024-03-01",
  "signatures": {
    "web_servers": {
      "apache": {
        "ports": [80, 443, 8080, 8443],
        "patterns": [
          "Apache(?:/([0-9.]+))?",
          "Server: Apache",
          "X-Powered-By: PHP"
        ],
        "banner_checks": {
          "directory_listing": {
            "pattern": "Index of /",
            "severity": "MEDIUM",
            "description": "Directory listing enabled"
          }
        },
        "vulnerabilities": {
          "2.4.49": {
            "cve": "CVE-2021-41773",
            "description": "Path Traversal vulnerability",
            "severity": "CRITICAL",
            "port_checks": [
              {
                "port": 80,
                "probe": "GET /cgi-bin/ HTTP/1.0\r\n\r\n",
                "response_pattern": "200 OK"
              }
            ]
          },
          "2.4.50": {
            "cve": "CVE-2021-42013", 
            "description": "Path Traversal vulnerability",
            "severity": "CRITICAL"
          }
        }
      },
      "nginx": {
        "ports": [80, 443, 8080],
        "patterns": [
          "nginx/([0-9.]+)",
          "Server: nginx"
        ],
        "vulnerabilities": {
          "1.20.0": {
            "cve": "CVE-2021-23017",
            "description": "Buffer overflow vulnerability",
            "severity": "HIGH",
            "port_checks": [
              {
                "port": 80,
                "probe": "GET / HTTP/1.1\r\nHost: localhost\r\nConnection: close\r\n\r\n",
                "response_pattern": "Server: nginx"
              }
            ]
          }
        }
      }
    },
    "database_servers": {
      "mysql": {
        "ports": [3306],
        "patterns": [
          "mysql_native_password",
          "MariaDB server"
        ],
        "banner_checks": {
          "exposed_version": {
            "pattern": "([0-9.]+)-MariaDB",
            "severity": "LOW",
            "description": "Database version exposed"
          }
        },
        "port_probes": [
          {
            "port": 3306,
            "data": "\\x0a\\x00\\x00\\x01\\x85\\xa6\\x3f\\x20",
            "timeout": 2
          }
        ],
        "vulnerabilities": {
          "5.7": {
            "cve": "CVE-2021-2154",
            "description": "Privilege Escalation vulnerability",
            "severity": "CRITICAL"
          }
        }
      },
      "postgresql": {
        "ports": [5432],
        "patterns": [
          "PostgreSQL ([0-9.]+)",
          "postgres"
        ],
        "port_probes": [
          {
            "port": 5432,
            "data": "\\x00\\x00\\x00\\x08\\x04\\xd2\\x16\\x2f",
            "timeout": 2
          }
        ],
        "vulnerabilities": {
          "13.0": {
            "cve": "CVE-2021-23214",
            "description": "SQL injection vulnerability",
            "severity": "HIGH"
          }
        }
      }
    },
    "mail_servers": {
      "smtp": {
        "ports": [25, 465, 587],
        "patterns": [
          "^220.*SMTP",
          "^220.*Postfix",
          "^220.*Exim"
        ],
        "banner_checks": {
          "open_relay": {
            "pattern": "220.*ready",
            "severity": "HIGH",
            "description": "Potential open relay"
          }
        },
        "port_probes": [
          {
            "port": 25,
            "data": "HELO test\r\n",
            "timeout": 3
          }
        ],
        "vulnerabilities": {
          "postfix_3.5.0": {
            "cve": "CVE-2021-20314",
            "description": "Memory corruption vulnerability",
            "severity": "HIGH"
          },
          "exim_4.94": {
            "cve": "CVE-2021-27216",
            "description": "Remote code execution vulnerability",
            "severity": "CRITICAL"
          }
        }
      }
    },
    "ssh_servers": {
      "openssh": {
        "ports": [22],
        "patterns": [
          "OpenSSH_([0-9.]+)",
          "SSH-2.0-OpenSSH"
        ],
        "banner_checks": {
          "version_disclosure": {
            "pattern": "SSH-2.0-OpenSSH_([0-9.]+)",
            "severity": "LOW",
            "description": "SSH version disclosed"
          }
        },
        "port_probes": [
          {
            "port": 22,
            "timeout": 2,
            "expect": "SSH-2.0-"
          }
        ],
        "vulnerabilities": {
          "8.5": {
            "cve": "CVE-2021-28041",
            "description": "Privilege escalation vulnerability", 
            "severity": "HIGH"
          }
        }
      }
    },
    "remote_services": {
      "rdp": {
        "ports": [3389],
        "patterns": [
          "Microsoft Terminal Services",
          "RDP"
        ],
        "port_probes": [
          {
            "port": 3389,
            "data": "\\x03\\x00\\x00\\x13\\x0e\\xe0\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x08\\x00\\x03\\x00\\x00\\x00",
            "timeout": 3
          }
        ],
        "vulnerabilities": {
          "any": {
            "cve": "CVE-2021-34535",
            "description": "Remote code execution vulnerability",
            "severity": "CRITICAL"
          }
        }
      },
      "vnc": {
        "ports": [5900],
        "patterns": [
          "VNC Server",
          "RFB"
        ],
        "port_probes": [
          {
            "port": 5900,
            "data": "RFB 003.008\\n",
            "timeout": 2
          }
        ],
        "vulnerabilities": {
          "any": {
            "cve": "CVE-2021-37417", 
            "description": "Authentication bypass vulnerability",
            "severity": "HIGH"
          }
        }
      }
    },
    "common_vulnerabilities": {
      "default_credentials": {
        "patterns": [
          "admin:admin",
          "root:root",
          "guest:guest"
        ],
        "severity": "CRITICAL",
        "description": "Default credentials detected"
      },
      "debug_info": {
        "patterns": [
          "DEBUG MODE",
          "TRACE:",
          "Stack trace:",
          "\\.py\", line \\d+",
          "\\.php on line \\d+"
        ],
        "severity": "MEDIUM",
        "description": "Debug information exposed"
      },
      "information_disclosure": {
        "patterns": [
          "internal server error",
          "sql error", 
          "exception details",
          "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
        ],
        "severity": "MEDIUM",
        "description": "Sensitive information disclosure"
      }
    },
    "port_specific_checks": {
      "21": {
        "probes": [
          {
            "data": "",
            "timeout": 2,
            "expect": "220"
          }
        ],
        "rules": [
          {
            "description": "FTP anonymous access",
            "pattern": "230.*login successful",
            "severity": "HIGH"
          }
        ]
      },
      "23": {
        "probes": [
          {
            "data": "\\r\\n",
            "timeout": 2
          }
        ],
        "rules": [
          {
            "description": "Telnet enabled",
            "severity": "HIGH"
          }
        ]
      },
      "161": {
        "probes": [
          {
            "data": "\\x30\\x26\\x02\\x01\\x01\\x04\\x06\\x70\\x75\\x62\\x6c\\x69\\x63\\xa0\\x19\\x02\\x01\\x00\\x02\\x01\\x00\\x02\\x01\\x00\\x30\\x0f\\x30\\x0d\\x06\\x09\\x2b\\x06\\x01\\x02\\x01\\x01\\x01\\x00\\x05\\x00",
            "timeout": 2
          }
        ],
        "rules": [
          {
            "description": "SNMP public community string",
            "pattern": "public",
            "severity": "HIGH"
          }
        ]
      }
    }
  },
  "mitigation": {
    "default_credentials": {
      "description": "Change default passwords immediately",
      "steps": [
        "Identify all affected services",
        "Change default passwords to strong, unique passwords",
        "Implement password policy",
        "Enable two-factor authentication where possible"
      ]
    },
    "debug_info": {
      "description": "Disable debug information in production",
      "steps": [
        "Review application configuration",
        "Disable debug mode",
        "Implement proper error handling",
        "Use production-appropriate logging levels"
      ]
    },
    "information_disclosure": {
      "description": "Prevent sensitive information leakage",
      "steps": [
        "Implement proper error handling",
        "Configure secure error pages",
        "Review and sanitize server responses",
        "Implement security headers"
      ]
    }
  },
  "scan_configurations": {
    "port_scan_options": {
      "connect_timeout": 2,
      "read_timeout": 3,
      "max_retries": 2,
      "thread_count": 50,
      "batch_size": 100
    },
    "default_ports": [20, 21, 22, 23, 25, 53, 80, 110, 111, 135, 139, 443, 445, 
                     3306, 3389, 5432, 5900, 8080],
    "timing_templates": {
      "paranoid": {
        "scan_delay": 0.5,
        "timeout": 5.0,
        "max_retries": 3,
        "max_rate": 10
      },
      "sneaky": {
        "scan_delay": 0.3,
        "timeout": 4.0,
        "max_retries": 3,
        "max_rate": 20
      },
      "normal": {
        "scan_delay": 0.1,
        "timeout": 2.0,
        "max_retries": 2,
        "max_rate": 100
      },
      "aggressive": {
        "scan_delay": 0.05,
        "timeout": 1.5,
        "max_retries": 1,
        "max_rate": 300
      }
    }
  }
}